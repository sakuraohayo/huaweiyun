<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Remember</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <!-- App favicon -->
        <link rel="shortcut icon" href="../assets/images/favicon_03.ico">

        <!-- Summernote css -->
        <link href="../assets/libs/summernote/summernote-bs4.css" rel="stylesheet" />

        <!-- Icons css -->
        <link href="../assets/libs/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />
        <link href="../assets/libs/dripicons/webfont/webfont.css" rel="stylesheet" type="text/css" />
        <link href="../assets/libs/simple-line-icons/css/simple-line-icons.css" rel="stylesheet" type="text/css" />

        <!-- App css -->
        <!-- build:css -->
        <link href="../assets/css/app.css" rel="stylesheet" type="text/css" />
        <!-- endbuild -->

    </head>

    <body>

       <!-- Navigation Bar-->
<header id="topnav">
    <nav class="navbar-custom">
        <div class="container-fluid">
            <ul class="list-unstyled topbar-right-menu float-right mb-0">
                <li class="dropdown notification-list">
                    <a class="navbar-toggle nav-link">
                        <div class="lines">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </a>
                    <!-- End mobile menu toggle-->
                </li>
                <li class="dropdown notification-list">
                    <a class="nav-link dropdown-toggle nav-user" data-toggle="dropdown" href="#" role="button"
                       aria-haspopup="false" aria-expanded="false">
                       <!-- <img src="../assets/images/users/avatar-1.jpg" alt="user" class="rounded-circle">  -->
                       <span class="ml-1"></span><i class="mdi mdi-chevron-down"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-animated profile-dropdown ">
                        <!-- i1tem-->
                        <div class="dropdown-item noti-title">
                            <h6 class="text-overflow m-0">欢迎！</h6>
                        </div>
                        <!-- item-->
                        <a href="personal-center.html" class="dropdown-item notify-item">
                            <i class="dripicons-user"></i> <span>我的账户</span>
                        </a>

                        <!-- item-->
                        <a href="auth-login.html" class="dropdown-item notify-item">
                            <i class="dripicons-power"></i> <span>退出</span>
                        </a>
                    </div>
                </li>
            </ul>
			
			<ul class="list-inline menu-left mb-0">
                <li class="float-left">
                    <a href="index_login.html" class="logo">
                        <span class="logo-lg">
                            <img src="../assets/images/Remember-logo.png" alt="" height="45">
                        </span>
                    </a>
                </li>
            </ul>
			
        </div>
    </nav>
    <!-- end topbar-main -->

    <div class="topbar-menu">
        <div class="container-fluid">
            <div id="navigation">
                <!-- Navigation Menu-->
                <ul class="navigation-menu">
                    <li class="has-submenu">
                        <a href="index_login.html"><i class="mdi mdi-view-dashboard"></i>主页</a>
                    </li>
					
					<li class="has-submenu">
                        <a href="#"><i class="mdi mdi-account"></i>个人中心</a>
                        <ul class="submenu">
                            <li><a href="personal-center.html">我的账户</a></li>
                            <li><a href="auth-recoverpassword.html">重置密码</a></li>
                            <li><a href="memory_manage.html">记忆管理</a></li>
                        </ul>
                    </li>
					
					<!-- <li class="has-submenu">
                        <a href="#"><i class="mdi mdi-email-outline"></i>个人中心</a>
                        <ul class="submenu">
                            <li><a href="personal-center.html">我的账户</a></li>
                            <li><a href="memory_manage.html">记忆管理</a></li>
                        </ul>
                    </li> -->

                    <li class="has-submenu">
                        <a href="memory_edit.html"><i class="mdi mdi-circle-edit-outline"></i>发布记忆</a>
                    </li>
                    <li class="has-submenu">
                        <a href="memory_search.html"><i class="mdi mdi-search-web"></i>记忆搜索</a>
                    </li>

                </ul>
                <!-- End navigation menu -->

                <div class="clearfix"></div>
            </div> <!-- end #navigation -->
        </div> <!-- end container -->
    </div> <!-- end navbar-custom -->
</header>
<!-- End Navigation Bar-->


        <div class="wrapper">
            <div class="container-fluid">

                <!-- Page title box -->
                <div class="page-title-alt-bg"></div>
                <div class="page-title-box">
                    <!-- <ol class="breadcrumb float-right">
                        <li class="breadcrumb-item"><a href="javascript:void(0);">主页</a></li>
                        <li class="breadcrumb-item"><a href="javascript:void(0);">个人中心</a></li>
                        <li class="breadcrumb-item active">我的账号</li>
                    </ol> -->
                    <h4 class="page-title">我的账号</h4>
                </div>
                <!-- End page title box -->


                <!-- Right Sidebar -->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-box">
                            <div class="inbox-rightbar">
								<div class="mt-4">
                                    <h5>默认账户信息</h5>

                                    <hr/>

                                    <div class="media mb-4 mt-1">
                                        <div class="media-body">
                                            <h6 class="m-0" id="username">时光的记忆</h6>
											<br>
											<small class="text-muted" id="birth">生日：2000.05.20</small>
											<br>
                                            <small class="text-muted" id="email">电子邮箱：123456@qq.com</small>
											<br>
											<small class="text-muted" id="motto">个性签名：海阔凭鱼跃，天高任鸟飞</small>
                                        </div>
										<div class="text-right">
											<button type="button" class="btn btn-block btn-success waves-effect waves-light" id="quit">退出登录</button>
										</div>
                                    </div>
									
									<hr/>
									
									<h5>用户名</h5>
									
									<hr/>
									
									<div class="media mb-4 mt-1">
										<div class="media-body">
											<input class="form-control" type="text" required="" id="userName" placeholder="请输入用户名">
                                        </div>
										<div class="text-right">
											<button type="button" class="btn btn-block btn-success waves-effect waves-light" id="edit_01">编辑</button>
										</div>
									</div>
									
									<hr/>
									
									<h5>生日</h5>
									
									<hr/>
									
									<div class="media mb-4 mt-1">
										<div class="media-body">
											<input class="form-control" type="date" required="" id="birthday" value="2020-12-20" placeholder="请输入时间：xxxx-xx-xx">
                                        </div>
										<div class="text-right">
											<button type="button" class="btn btn-block btn-success waves-effect waves-light" id="edit_03">编辑</button>
										</div>
									</div>
									
									<hr/>
									
									<h5>个性签名</h5>
									
									<hr/>
									
									<div class="media mb-4 mt-1">
										<div class="media-body">
											<input class="form-control" type="text" required="" id="maxim" placeholder="请输入个性签名">
                                        </div>
										<div class="text-right">
											<button type="button" class="btn btn-block btn-success waves-effect waves-light" id="edit_05">编辑</button>
										</div>
									</div>

                                </div> <!-- card-box -->

                            </div> 
                            <!-- end inbox-rightbar-->

                            <div class="clearfix"></div>
                        </div>

                    </div> <!-- end Col -->

                </div><!-- End row -->

            </div> <!-- end container -->
        </div>
        <!-- end wrapper -->

        <!-- jQuery  -->
        <script src="../assets/libs/jquery/jquery.min.js"></script>
        <script src="../assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="../assets/libs/jquery-slimscroll/jquery.slimscroll.min.js"></script>

        <!--Summernote js-->
        <script src="../assets/libs/summernote/summernote-bs4.min.js"></script>

        <!-- App js -->
        <script src="../assets/js/jquery.core.js"></script>
        <script src="../assets/js/jquery.app.js"></script>
		<script src="https://cdn.staticfile.org/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

        <script>
            jQuery(document).ready(function(){

                $("span.ml-1").text($.cookie('username'));

				//设置文本框不可编辑
				$("#userName").attr("readonly","readonly");
				$("#birthday").attr("readonly","readonly");
				$("#maxim").attr("readonly","readonly");
				
				$.ajaxSetup({
					complete:function(xhr,status){
						xhr.getAllResponseHeaders();
						console.log(xhr)
						let REDIRECT = xhr.getResponseHeader("REDIRECT");
						if(REDIRECT === "redirect"){
							window.location.href = "auth-login.html";
						}
					}
				})
				
				$.ajax({                     
					async:true,　　　　　　　
					url:"http://remember.icube.fun:8080/userInfo",            //引号内为处理数据的代码地址，如果是php就是test.php
					type:"post",  //请求方式 ("POST" 或 "GET")， 默认为 "GET"
					data:{},
					dataType:"json",
					headers: {'token':$.cookie('token')},
					success: function(result){
						if(result["code"] == 7){
							//alert(result["message"]);
							var username = result["data"]["username"];
							var birth = result["data"]["birthday"];
							var email = result["data"]["email"];
							var motto = result["data"]["personalSignature"];
							var userName = username;
							var birthday = birth;
							var maxim = motto;
							$("#name").html(username);
							$("#username").html(username);
							$("#birth").html(birth);
							$("#email").html(email);
							$("#motto").html(motto);
							$("#userName").val(userName);
							$("#birthday").val(birthday);
							$("#maxim").val(maxim);
						}
						else if(result["code"] == -6){
							alert(result["message"]);
						}
						else if(result["code"] == -2){
							alert(result["message"]);
						}
					},
					error:function(XMLHttpRequest, textStatus, errorThrown){
                        alert("网络请求错误！");
						// alert("请求对象XMLHttpRequest: "+XMLHttpRequest);
						// alert("错误类型textStatus: "+textStatus);
						// alert("异常对象errorThrown: "+errorThrown);
					}
				});	
            });
        </script>
		
		<script>
			$("#quit").on("click",function(){
				window.location.href = "auth-login.html";
			});
			
			$("#edit_01").on("click",function(){
				var name = prompt("请输入用户名","");
				if (name != null && name != "") {
					alert("你输入的用户名是：" + name);
				}else{
					alert("取消修改");
					test_prompt();
				}
				
				$("#userName").val(name);
				
				var username = $("#userName").val();
				
				var data = {
					username:username,
				};
				
				$.ajax({                     
					async:true,　　　　　　　
					url:"http://remember.icube.fun:8080/username",            //引号内为处理数据的代码地址，如果是php就是test.php
					type:"post",
					data:data,
					dataType:"json",
					headers: {'token':$.cookie('token')},
					success: function(result){
						if(result["code"] == 4){
							alert(result["message"]);
							window.location.href = "personal-center.html";
						}
						else if(result["code"] == -8){
							alert(result["message"]);
						}
						else if(result["code"] == -2){
							alert(result["message"]);
						}
					},
					error:function(XMLHttpRequest, textStatus, errorThrown){
                        alert("网络请求错误！");
						// alert("请求对象XMLHttpRequest: "+XMLHttpRequest);
						// alert("错误类型textStatus: "+textStatus);
						// alert("异常对象errorThrown: "+errorThrown);
					}
				});
			});
			
			$("#edit_03").on("click",function(){
			
				var date = /^(\d{4})-(0\d{1}|1[0-2])-(0\d{1}|[12]\d{1}|3[01])$/; 
				
				var name = prompt("请输入生日","");
				if (name != null && name != "") {
					alert("你输入的生日是：" + name);
				}else{
					alert("取消修改");
					test_prompt();
				}

				$("#birthday").val(name);
				
				var birthday = $("#birthday").val();
				
				var data = {
					birthday:birthday,
				};
				
				$.ajax({                     
					async:true,　　　　　　　
					url:"http://remember.icube.fun:8080/birthday",            //引号内为处理数据的代码地址，如果是php就是test.php
					type:"post",
					data:data,
					dataType:"json",
					headers: {'token':$.cookie('token')},
					success: function(result){
						if(result["code"] == 5){
							alert(result["message"]);
							window.location.href = "personal-center.html";
						}
						else if(result["code"] == -9){
							alert(result["message"]);
						}
						else if(result["code"] == -2){
							alert(result["message"]);
						}
					},
					error:function(XMLHttpRequest, textStatus, errorThrown){
                        alert("网络请求错误！");
						// alert("请求对象XMLHttpRequest: "+XMLHttpRequest);
						// alert("错误类型textStatus: "+textStatus);
						// alert("异常对象errorThrown: "+errorThrown);
					}
				});
			});
			
			$("#edit_05").on("click",function(){
				var name = prompt("请输入个性签名","");
				if (name != null && name != "") {
					alert("你输入的个性签名是：" + name);
				}else{
					alert("取消修改");
					// test_prompt();
				}
				
				$("#maxim").val(name);
				
				var maxim = $("#maxim").val();
				
				var data = {
					personalSignature:maxim,
				};
				
				$.ajax({                     
					async:true,　　　　　　　
					url:"http://remember.icube.fun:8080/personalSignature",            //引号内为处理数据的代码地址，如果是php就是test.php
					type:"post",
					data:data,
					dataType:"json",
					headers: {'token':$.cookie('token')},
					success: function(result){
						if(result["code"] == 6){
							alert(result["message"]);
							window.location.href = "personal-center.html";
						}
						else if(result["code"] == -10){
							alert(result["message"]);
						}
						else if(result["code"] == -2){
							alert(result["message"]);
						}
					},
					error:function(XMLHttpRequest, textStatus, errorThrown){
                        alert("网络请求错误！");
						// alert("请求对象XMLHttpRequest: "+XMLHttpRequest);
						// alert("错误类型textStatus: "+textStatus);
						// alert("异常对象errorThrown: "+errorThrown);
					}
				});
			});
		</script>
		
		<script>
			function disp_prompt(){
				var name=prompt("输入的内容","");
				if (name!=null && name!="") {
					alert("你输入的是：" + name);
					return name;
				}
			}
		</script>

    </body>
</html>
